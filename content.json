{"meta":{"title":"JeasonLau's Blog","subtitle":null,"description":null,"author":"JeasonLau","url":"http://yoursite.com","root":"/"},"pages":[{"title":"categories","date":"2019-07-03T03:49:06.000Z","updated":"2019-07-03T03:52:00.000Z","comments":false,"path":"categories/index.html","permalink":"http://yoursite.com/categories/index.html","excerpt":"","text":""},{"title":"tags","date":"2019-07-03T03:49:23.000Z","updated":"2019-07-03T03:52:41.000Z","comments":false,"path":"tags/index.html","permalink":"http://yoursite.com/tags/index.html","excerpt":"","text":""}],"posts":[{"title":"php表单提交并自动发送邮件","slug":"formSubmit","date":"2019-10-29T13:41:34.000Z","updated":"2019-10-29T15:52:47.422Z","comments":true,"path":"2019/10/29/formSubmit/","link":"","permalink":"http://yoursite.com/2019/10/29/formSubmit/","excerpt":"","text":"最近在html5up上淘了个主页模板，模板底有一个表单，今天在修改模板的时候，朋友提起可以配置表单实现提交表单时自动发送邮件通知，于是就萌生了这个想法，结果没想到一搞就是三四个小时（主要是因为网上的某些“教程”太坑人了！），所以记录一下配置过程给后来人参考。 给服务器安装php,php-fpm作者使用的是ubuntu18.04，所以使用 12sudo apt-get install phpsudo apt-get install php-fpm web服务器添加php支持作者使用的是nginx，为支持php需要修改一下配置文件，网上不少教程说要改nginx.conf，但我发现我这里的配置文件和他们的有很大差异，后来实测修改/etc/nginx/sites-available/default有效。将文件与php有关部分修改为： 123456789101112131415161718192021222324252627282930 # Add index.php to the list if you are using PHP index index.html index.htm index.nginx-debian.html index.php; server_name _; # nginx不允许静态文件响应post请求，会出现405 now allowed提示，所以需要添加以下内容# 需要开启8080端口，或者可以修改为目前已经开启的端口（或许吧，我查到的教程中写的8080，我直接粘贴的，懒得改了） error_page 405 =200 @405; location @405 &#123; proxy_method GET; proxy_pass http://你的地址:8080; &#125; location / &#123; # First attempt to serve request as file, then # as directory, then fall back to displaying a 404. try_files $uri $uri/ =404; &#125; # pass PHP scripts to FastCGI server # location ~ \\.php$ &#123; include snippets/fastcgi-php.conf; # With php-fpm (or other unix sockets): # 这里需要把php7.2修改为安装php时显示的版本 fastcgi_pass unix:/var/run/php/php7.2-fpm.sock; # With php-cgi (or other tcp sockets): # fastcgi_pass 127.0.0.1:9000; &#125; 修改表单所在的html文件接下来打开表单所在的html文件，修改form标签，例如我的： 123456789101112131415161718192021&lt;!--其实粘贴这么多只是想说form标签需要加个action=\"mail.php\"啦（滑稽）--&gt;&lt;form method=\"post\" action=\"mail.php\"&gt; &lt;div class=\"fields\"&gt; &lt;div class=\"field half\"&gt; &lt;label for=\"name\"&gt;Name&lt;/label&gt; &lt;input type=\"text\" name=\"name\" id=\"name\" /&gt; &lt;/div&gt; &lt;div class=\"field half\"&gt; &lt;label for=\"email\"&gt;Email&lt;/label&gt; &lt;input type=\"text\" name=\"email\" id=\"email\" /&gt; &lt;/div&gt; &lt;div class=\"field\"&gt; &lt;label for=\"message\"&gt;Message&lt;/label&gt; &lt;textarea name=\"message\" id=\"message\" rows=\"6\"&gt;&lt;/textarea&gt; &lt;/div&gt; &lt;/div&gt; &lt;ul class=\"actions\"&gt; &lt;li&gt;&lt;input type=\"submit\" value=\"Send Message\" class=\"primary\" /&gt;&lt;/li&gt; &lt;li&gt;&lt;input type=\"reset\" value=\"Clear\" /&gt;&lt;/li&gt; &lt;/ul&gt;&lt;/form&gt; 配置mail.php文件（重要！）form提交将会调用mail.php文件，接下来就需要配置它了。我（消耗了95%的时间）浏览了许多网站，发现网上大体只有两个模板，即这个和这个。但亲身体验后发现都！不！能！用！第一个是单纯的配置文件问题，我把各项修改好后还是不能用。（或许是因为我多删了点东西？）第二个则使用了php的mail()函数，不过很不幸的是，正如这篇最后解决我问题的文章中写的一样： PHP环境下，是提供了发送邮件的函数mail()的，不过该函数要求服务器支持sendmail或者必须设置一台不需要中继的邮件发送服务器，但现在要找到一台不需要身份验证的邮件发送中继几乎不可能，所以使用mail函数往往无法成功发送电子邮件。 mail()函数确实无法成功发送邮件。这篇文章同样给出了一个解决办法，就是使用PHPMailer。 将其git clone到服务器并解压，mail.php只需按照README.md中所给的Example进行微量修改，我的大概为： 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960&lt;?php// Import PHPMailer classes into the global namespace// These must be at the top of your script, not inside a functionuse PHPMailer\\PHPMailer\\PHPMailer;use PHPMailer\\PHPMailer\\SMTP;use PHPMailer\\PHPMailer\\Exception;// 修改这三个文件的路径为服务器路径require './PHPMailer/src/Exception.php';require './PHPMailer/src/PHPMailer.php';require './PHPMailer/src/SMTP.php';// 这里将内容对应改成form标签中各项的名字$email=$_POST['email'];$name=$_POST['name'];$message=$_POST['message'];// Instantiation and passing `true` enables exceptions$mail = new PHPMailer(true);// 这里我使用的是qq邮箱，其它邮箱同理try &#123; //Server settings $mail-&gt;SMTPDebug = SMTP::DEBUG_SERVER; // Enable verbose debug output $mail-&gt;isSMTP(); // Send using SMTP $mail-&gt;Host = 'smtp.qq.com'; // Set the SMTP server to send through $mail-&gt;SMTPAuth = true; // Enable SMTP authentication $mail-&gt;Username = '邮箱的用户名'; // SMTP username $mail-&gt;Password = '邮箱的密码'; // SMTP password// $mail-&gt;SMTPSecure = PHPMailer::ENCRYPTION_STARTTLS; // Enable TLS encryption; `PHPMailer::ENCRYPTION_SMTPS` also accepted $mail-&gt;SMTPSecure = 'ssl'; $mail-&gt;Port = 465; // TCP port to connect to //Recipients $mail-&gt;setFrom('邮箱的用户名', '随便填个昵称'); $mail-&gt;addAddress('发送到的邮箱', '随便填个昵称'); // Add a recipient // 后边的那些我不用，就注释掉了// $mail-&gt;addAddress('ellen@example.com'); // Name is optional// $mail-&gt;addReplyTo('info@example.com', 'Information');// $mail-&gt;addCC('cc@example.com');// $mail-&gt;addBCC('bcc@example.com'); // Attachments// $mail-&gt;addAttachment('/var/tmp/file.tar.gz'); // Add attachments// $mail-&gt;addAttachment('/tmp/image.jpg', 'new.jpg'); // Optional name // Content $mail-&gt;isHTML(true); // Set email format to HTML $mail-&gt;Subject = \"An E-mail from $email\"; $mail-&gt;Body = \"This e-mail is written by $name : $message\"; // 我在测试时，AltBody中的内容并不会在邮件中显示出来，目前暂时不清楚有什么用 $mail-&gt;AltBody = \"\"; $mail-&gt;send(); echo 'Message has been sent';&#125; catch (Exception $e) &#123; echo \"Message could not be sent. Mailer Error: &#123;$mail-&gt;ErrorInfo&#125;\";&#125; 结语经过这些配置之后，你的表单应该可以正常发送邮件了，唯一的不足是在点击提交之后会跳转出现一堆提示信息，影响观感，查询后得知可以使用ajax实现提交不跳转，现在不早了先不搞了，明天有时间，配置成功的话可能会继续更新，敬请期待！（","categories":[{"name":"网站建设","slug":"网站建设","permalink":"http://yoursite.com/categories/网站建设/"}],"tags":[{"name":"php","slug":"php","permalink":"http://yoursite.com/tags/php/"},{"name":"网站","slug":"网站","permalink":"http://yoursite.com/tags/网站/"}]},{"title":"python学习笔记","slug":"pynote","date":"2019-09-21T16:16:06.000Z","updated":"2019-09-21T16:16:45.696Z","comments":true,"path":"2019/09/22/pynote/","link":"","permalink":"http://yoursite.com/2019/09/22/pynote/","excerpt":"","text":"","categories":[{"name":"学习笔记","slug":"学习笔记","permalink":"http://yoursite.com/categories/学习笔记/"}],"tags":[{"name":"笔记","slug":"笔记","permalink":"http://yoursite.com/tags/笔记/"},{"name":"python","slug":"python","permalink":"http://yoursite.com/tags/python/"}]},{"title":"javascript学习笔记","slug":"jsnote","date":"2019-09-13T15:30:43.000Z","updated":"2019-09-21T16:20:38.883Z","comments":true,"path":"2019/09/13/jsnote/","link":"","permalink":"http://yoursite.com/2019/09/13/jsnote/","excerpt":"","text":"判断数据类型 type(a)：显示a的类型 isinstance(a,int)：返回true或false 区别在于： type()不会认为子类是一种父类类型 isinstance()会认为子类是一种父类类型 十六进制和八进制 十六进制的标示为0x 八进制的标示为0o //的问题在整数除法中，除法/总是返回一个浮点数，如果只想得到整数的结果，丢弃可能的分数部分，可以使用//。注意://得到的并不一定是整数类型的数，它与分母分子的数据类型有关系。 12347//237.0//23.0 _变量在交互模式中，最后被输入的表达式结果被赋值给变量_。","categories":[{"name":"学习笔记","slug":"学习笔记","permalink":"http://yoursite.com/categories/学习笔记/"}],"tags":[{"name":"javascript","slug":"javascript","permalink":"http://yoursite.com/tags/javascript/"},{"name":"笔记","slug":"笔记","permalink":"http://yoursite.com/tags/笔记/"}]},{"title":"manjaro搜狗输入法libfcitx-qt.so错误","slug":"fixSogouInput","date":"2019-08-21T00:59:19.000Z","updated":"2019-09-21T16:13:39.489Z","comments":true,"path":"2019/08/21/fixSogouInput/","link":"","permalink":"http://yoursite.com/2019/08/21/fixSogouInput/","excerpt":"","text":"在一次fcitx的更新后，我的搜狗输入法出现了异常，通知栏提示 1搜狗输入法异常！请删除.config/SogouPY并重启 按照提示删除了~/.config/SogouPY目录，重启电脑过后仍然提示此问题。于是在终端中输入sogou-qimpanel获取错误信息，输出为 1error while loading shared libraries: libfcitx-qt.so.0: cannot open shared object file: No such file or directory 查阅资料后得知是因为缺少fcitx-qt4，于是试图安装： 1yay -S fcitx-qt4 却在获取源代码时提示 1Warning: Transient problem: HTTP error Will retry in 3 seconds. 进一步排查得知，AUR上fcitx-qt4的source链接已经挂掉无法使用。于是在google上搜索fcitx-qt4-4.2.9.6-1-x86_64.pkg.tar.xz，找到可用的下载链接。 下载后将其移动到~/.cache/yay/fcitx-qt4目录下，重新使用yay安装fcitx-qt4，在询问Packages to cleanBuild?时输入N即可正常安装，安装完成后问题解决。","categories":[{"name":"故障修复","slug":"故障修复","permalink":"http://yoursite.com/categories/故障修复/"}],"tags":[{"name":"linux","slug":"linux","permalink":"http://yoursite.com/tags/linux/"},{"name":"manjaro","slug":"manjaro","permalink":"http://yoursite.com/tags/manjaro/"}]},{"title":"manjaro常用的垃圾清理命令","slug":"cleanUpFiles","date":"2019-08-12T07:17:25.000Z","updated":"2019-09-21T16:14:07.646Z","comments":true,"path":"2019/08/12/cleanUpFiles/","link":"","permalink":"http://yoursite.com/2019/08/12/cleanUpFiles/","excerpt":"","text":"清除系统中无用的包 1sudo pacman -R $(pacman -Qdtq) 清除已下载的安装包 1sudo pacman -Scc 日志垃圾 查看日志文件 123du -t 100M /varorjournalctl --disk-usage 删除指定大小日志文件 1sudo journalctl --vacuum-size=50M","categories":[{"name":"系统优化","slug":"系统优化","permalink":"http://yoursite.com/categories/系统优化/"}],"tags":[{"name":"linux","slug":"linux","permalink":"http://yoursite.com/tags/linux/"},{"name":"manjaro","slug":"manjaro","permalink":"http://yoursite.com/tags/manjaro/"}]},{"title":"禁用笔记本自带键盘的方法","slug":"disableKeyboard","date":"2019-07-03T04:13:55.000Z","updated":"2019-09-21T16:14:46.269Z","comments":true,"path":"2019/07/03/disableKeyboard/","link":"","permalink":"http://yoursite.com/2019/07/03/disableKeyboard/","excerpt":"","text":"Windows禁用用管理员权限运行cmd，在其中输入： 1sc config i8042prt start= disabled 之后重启即可。 恢复与禁用的步骤相同，把输入的命令改为： 1sc config i8042prt start= demand Linux注意：manjaro需要使用 1sudo pacman -S xorg-xinput 进行安装以使用xinput命令。 打开终端，输入xinput --list获取设备列表： 123456789101112131415161718❯ xinput --list ⎡ Virtual core pointer id=2 [master pointer (3)]⎜ ↳ Virtual core XTEST pointer id=4 [slave pointer (2)]⎜ ↳ USB Optical Mouse Mouse id=14 [slave pointer (2)]⎜ ↳ Synaptics TM3253-001 id=11 [slave pointer (2)]⎣ Virtual core keyboard id=3 [master keyboard (2)] ↳ Virtual core XTEST keyboard id=5 [slave keyboard (3)] ↳ Power Button id=6 [slave keyboard (3)] ↳ Video Bus id=7 [slave keyboard (3)] ↳ Power Button id=8 [slave keyboard (3)] ↳ Sleep Button id=9 [slave keyboard (3)] ↳ Integrated_Webcam_HD: Integrate id=10 [slave keyboard (3)] ↳ Dell WMI hotkeys id=12 [slave keyboard (3)] ↳ AT Translated Set 2 keyboard id=13 [slave keyboard (3)] ↳ DELL Wireless hotkeys id=15 [slave keyboard (3)] ↳ USB Keyboard Consumer Control id=16 [slave keyboard (3)] ↳ USB Keyboard System Control id=17 [slave keyboard (3)] ↳ USB Keyboard id=18 [slave keyboard (3)] 找到AT Translated Set 2 keyboard对应的id（本机为13）。 禁用在终端中输入 1xinput set-prop 13 \"Device Enabled\" 0 恢复在终端中输入 1xinput set-prop 13 \"Device Enabled\" 1","categories":[{"name":"系统优化","slug":"系统优化","permalink":"http://yoursite.com/categories/系统优化/"}],"tags":[{"name":"linux","slug":"linux","permalink":"http://yoursite.com/tags/linux/"},{"name":"windows","slug":"windows","permalink":"http://yoursite.com/tags/windows/"}]}]}